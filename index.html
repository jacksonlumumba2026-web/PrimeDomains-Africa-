<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login | PrimeDomains Africa</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
<style>
body{margin:0;font-family:"Poppins",sans-serif;background:#f5f7fa;display:flex;align-items:center;justify-content:center;height:100vh;}
.container{background:white;padding:40px;border-radius:12px;box-shadow:0 5px 20px rgba(0,0,0,0.1);text-align:center;width:350px;}
h2{margin-bottom:25px;color:#0d1b2a;}
button{padding:12px 20px;border:none;border-radius:8px;background:#00b4d8;color:white;font-size:16px;cursor:pointer;}
button:hover{background:#0096c7;}
</style>
</head>
<body>

<div class="container">
<h2>Login to PrimeDomains Africa</h2>
<button id="googleLoginBtn">Login with Google</button>
</div>

<script type="module">
import { auth, db } from "./firebase-config.js";
import { GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";
import { doc, getDoc } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const provider = new GoogleAuthProvider();

async function loginWithGoogle(){
  try {
    const result = await signInWithPopup(auth, provider);
    const user = result.user;

    const docRef = doc(db, "users", user.uid);
    const docSnap = await getDoc(docRef);

    if(!docSnap.exists()){
      alert("Your account is not registered in the platform. Contact admin.");
      return;
    }

    const role = docSnap.data().role;
    if(role === "admin") window.location.href = "admin-dashboard.html";
    else if(role === "seller") window.location.href = "seller-dashboard.html";
    else if(role === "buyer") window.location.href = "buyer-dashboard.html";
    else alert("Role not recognized");

  } catch(error){
    console.error(error);
    alert("Login failed: " + error.message);
  }
}

document.getElementById("googleLoginBtn").addEventListener("click", loginWithGoogle);
</script>

</body>
</html>
